Lab #5
========================================================

## ---- R Lab #5 -----
## (due Dec. 1)

## 1. Run a multiple linear probability model.  Tell me how you think your independent variables will affect your dependent variable.  Interpret your results.  Were your expectations correct?  Why or why not?


```r
## install.packages("devtools")
## library(devtools)
## install_github("jgabry/QMSS_package")

library(QMSS)
```

```
## Loading required package: lme4
## Loading required package: lattice
## Loading required package: Matrix
## Loading required package: lmtest
## Loading required package: zoo
## 
## Attaching package: 'zoo'
## 
## The following objects are masked from 'package:base':
## 
##     as.Date, as.Date.numeric
## 
## Loading required package: MASS
## Loading required package: plm
## Loading required package: Formula
## Loading required package: plyr
## Loading required package: rdd
## Loading required package: sandwich
## Loading required package: AER
## Loading required package: car
## Loading required package: survival
## Loading required package: VGAM
## Loading required package: splines
## Loading required package: stats4
## 
## Attaching package: 'VGAM'
## 
## The following object is masked from 'package:AER':
## 
##     tobit
## 
## The following object is masked from 'package:car':
## 
##     logit
## 
## The following object is masked from 'package:lmtest':
## 
##     lrtest
```

```r
setwd("~/Downloads")

d= read.csv("GSS.2006.csv.xls")

## d = read.csv(file.choose()) ## choose the 2006 GSS ##

sub <- d[, c("xhaustn", "hrs1", "age", "prestg80", "babies", "wrkstat")]

sub <- na.omit(sub) ## get rid of all missings; necessary for predictions later ##

sub$exh = ifelse(sub$xhaustn==1, 1, 0) ## only look at "always exhausted" vs. everything else ##

table(sub$exh)
```

```
## 
##   0   1 
## 785 130
```

```r
lm1 = lm(exh ~ hrs1 + age + prestg80 + babies, sub, subset= wrkstat==1)
summary(lm1)
```

```
## 
## Call:
## lm(formula = exh ~ hrs1 + age + prestg80 + babies, data = sub, 
##     subset = wrkstat == 1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.3968 -0.1630 -0.1233 -0.0699  0.9769 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  0.015809   0.077304    0.20  0.83801    
## hrs1         0.004162   0.001141    3.65  0.00028 ***
## age          0.001153   0.001097    1.05  0.29380    
## prestg80    -0.002771   0.000887   -3.13  0.00184 ** 
## babies       0.054517   0.025599    2.13  0.03351 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.343 on 778 degrees of freedom
## Multiple R-squared:  0.0315,	Adjusted R-squared:  0.0265 
## F-statistic: 6.32 on 4 and 778 DF,  p-value: 5.23e-05
```

## 2. Run a multiple (binary) logistic model.  (It can be the same as the above LPM or -- even better -- a new model.)  Tell me how you think your independent variables will affect your dependent variable.  Interpret your results in the logit scale.  Were your expectations correct?  Why or why not?


```r
logit1 = glm(exh ~ hrs1 + age + prestg80 + babies, sub, subset= wrkstat==1, family=binomial)
summary(logit1)
```

```
## 
## Call:
## glm(formula = exh ~ hrs1 + age + prestg80 + babies, family = binomial, 
##     data = sub, subset = wrkstat == 1)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.246  -0.584  -0.497  -0.400   2.444  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(>|z|)    
## (Intercept) -2.71990    0.65426   -4.16  3.2e-05 ***
## hrs1         0.03183    0.00884    3.60  0.00032 ***
## age          0.00954    0.00949    1.00  0.31512    
## prestg80    -0.02474    0.00813   -3.04  0.00234 ** 
## babies       0.40253    0.18880    2.13  0.03301 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 635.55  on 782  degrees of freedom
## Residual deviance: 611.64  on 778  degrees of freedom
## AIC: 621.6
## 
## Number of Fisher Scoring iterations: 5
```

## 3. Get odds ratios from your logit model in Question 2 and interpret some of them.  


```r
exp(coef(logit1))
```

```
## (Intercept)        hrs1         age    prestg80      babies 
##     0.06588     1.03234     1.00958     0.97557     1.49560
```

## 4. Get predicted probabilities from your logit model in Question 2 for some constellations of X values and interpret the results. 


```r
predict(logit1, type = "response", newdata = data.frame(hrs1 = c(35,80), age = c(35, 35), prestg80 = c(50, 50), babies = c(0,0)))
```

```
##       1       2 
## 0.07523 0.25412
```

```r
predict(logit1,  type = "response", newdata = data.frame( hrs1 = c(45,45), age = c(35, 35), prestg80 = c(50, 50), babies = c(0,2)))
```

```
##      1      2 
## 0.1006 0.2001
```

```r
predict(logit1,  type = "response", newdata = data.frame( hrs1 = c(35,60), age = c(20, 50), prestg80 = c(40, 80), babies = c(0,2)))
```

```
##       1       2 
## 0.08282 0.18134
```

```r
## the below will get it for any combination of variables and everything else set to means ##

pred.dat <- with(sub, expand.grid( 
  hrs1 = sort(unique(hrs1)),
  age = mean(age),
  prestg80 = mean(prestg80),
  babies = sort(unique(babies))))


predProb(logit1, predData = pred.dat, ci = F)
```

```
##     hrs1   age prestg80 babies PredictedProb
## 1      1 42.77    44.41      0       0.03297
## 2      2 42.77    44.41      0       0.03400
## 3      4 42.77    44.41      0       0.03615
## 4      5 42.77    44.41      0       0.03728
## 5      6 42.77    44.41      0       0.03844
## 6      8 42.77    44.41      0       0.04086
## 7     10 42.77    44.41      0       0.04343
## 8     12 42.77    44.41      0       0.04615
## 9     13 42.77    44.41      0       0.04757
## 10    14 42.77    44.41      0       0.04904
## 11    15 42.77    44.41      0       0.05054
## 12    16 42.77    44.41      0       0.05209
## 13    17 42.77    44.41      0       0.05369
## 14    18 42.77    44.41      0       0.05533
## 15    20 42.77    44.41      0       0.05875
## 16    21 42.77    44.41      0       0.06053
## 17    24 42.77    44.41      0       0.06620
## 18    25 42.77    44.41      0       0.06819
## 19    26 42.77    44.41      0       0.07024
## 20    27 42.77    44.41      0       0.07235
## 21    28 42.77    44.41      0       0.07451
## 22    29 42.77    44.41      0       0.07674
## 23    30 42.77    44.41      0       0.07903
## 24    31 42.77    44.41      0       0.08137
## 25    32 42.77    44.41      0       0.08378
## 26    33 42.77    44.41      0       0.08626
## 27    34 42.77    44.41      0       0.08880
## 28    35 42.77    44.41      0       0.09141
## 29    36 42.77    44.41      0       0.09409
## 30    37 42.77    44.41      0       0.09684
## 31    38 42.77    44.41      0       0.09966
## 32    39 42.77    44.41      0       0.10255
## 33    40 42.77    44.41      0       0.10552
## 34    41 42.77    44.41      0       0.10856
## 35    42 42.77    44.41      0       0.11168
## 36    43 42.77    44.41      0       0.11487
## 37    44 42.77    44.41      0       0.11815
## 38    45 42.77    44.41      0       0.12151
## 39    46 42.77    44.41      0       0.12494
## 40    47 42.77    44.41      0       0.12847
## 41    48 42.77    44.41      0       0.13207
## 42    49 42.77    44.41      0       0.13576
## 43    50 42.77    44.41      0       0.13954
## 44    51 42.77    44.41      0       0.14341
## 45    52 42.77    44.41      0       0.14736
## 46    53 42.77    44.41      0       0.15140
## 47    54 42.77    44.41      0       0.15554
## 48    55 42.77    44.41      0       0.15977
## 49    56 42.77    44.41      0       0.16408
## 50    57 42.77    44.41      0       0.16850
## 51    58 42.77    44.41      0       0.17300
## 52    60 42.77    44.41      0       0.18230
## 53    62 42.77    44.41      0       0.19198
## 54    64 42.77    44.41      0       0.20205
## 55    65 42.77    44.41      0       0.20723
## 56    66 42.77    44.41      0       0.21251
## 57    67 42.77    44.41      0       0.21788
## 58    70 42.77    44.41      0       0.23459
## 59    72 42.77    44.41      0       0.24622
## 60    75 42.77    44.41      0       0.26436
## 61    78 42.77    44.41      0       0.28334
## 62    80 42.77    44.41      0       0.29645
## 63    85 42.77    44.41      0       0.33067
## 64    88 42.77    44.41      0       0.35214
## 65    89 42.77    44.41      0       0.35943
## 66     1 42.77    44.41      1       0.04852
## 67     2 42.77    44.41      1       0.05001
## 68     4 42.77    44.41      1       0.05312
## 69     5 42.77    44.41      1       0.05474
## 70     6 42.77    44.41      1       0.05641
## 71     8 42.77    44.41      1       0.05990
## 72    10 42.77    44.41      1       0.06358
## 73    12 42.77    44.41      1       0.06748
## 74    13 42.77    44.41      1       0.06951
## 75    14 42.77    44.41      1       0.07160
## 76    15 42.77    44.41      1       0.07374
## 77    16 42.77    44.41      1       0.07595
## 78    17 42.77    44.41      1       0.07821
## 79    18 42.77    44.41      1       0.08054
## 80    20 42.77    44.41      1       0.08538
## 81    21 42.77    44.41      1       0.08790
## 82    24 42.77    44.41      1       0.09586
## 83    25 42.77    44.41      1       0.09865
## 84    26 42.77    44.41      1       0.10152
## 85    27 42.77    44.41      1       0.10446
## 86    28 42.77    44.41      1       0.10747
## 87    29 42.77    44.41      1       0.11057
## 88    30 42.77    44.41      1       0.11374
## 89    31 42.77    44.41      1       0.11698
## 90    32 42.77    44.41      1       0.12031
## 91    33 42.77    44.41      1       0.12372
## 92    34 42.77    44.41      1       0.12721
## 93    35 42.77    44.41      1       0.13079
## 94    36 42.77    44.41      1       0.13445
## 95    37 42.77    44.41      1       0.13820
## 96    38 42.77    44.41      1       0.14203
## 97    39 42.77    44.41      1       0.14595
## 98    40 42.77    44.41      1       0.14997
## 99    41 42.77    44.41      1       0.15407
## 100   42 42.77    44.41      1       0.15826
## 101   43 42.77    44.41      1       0.16255
## 102   44 42.77    44.41      1       0.16693
## 103   45 42.77    44.41      1       0.17140
## 104   46 42.77    44.41      1       0.17597
## 105   47 42.77    44.41      1       0.18063
## 106   48 42.77    44.41      1       0.18539
## 107   49 42.77    44.41      1       0.19025
## 108   50 42.77    44.41      1       0.19520
## 109   51 42.77    44.41      1       0.20025
## 110   52 42.77    44.41      1       0.20539
## 111   53 42.77    44.41      1       0.21063
## 112   54 42.77    44.41      1       0.21598
## 113   55 42.77    44.41      1       0.22141
## 114   56 42.77    44.41      1       0.22695
## 115   57 42.77    44.41      1       0.23258
## 116   58 42.77    44.41      1       0.23831
## 117   60 42.77    44.41      1       0.25006
## 118   62 42.77    44.41      1       0.26218
## 119   64 42.77    44.41      1       0.27468
## 120   65 42.77    44.41      1       0.28107
## 121   66 42.77    44.41      1       0.28754
## 122   67 42.77    44.41      1       0.29411
## 123   70 42.77    44.41      1       0.31431
## 124   72 42.77    44.41      1       0.32819
## 125   75 42.77    44.41      1       0.34958
## 126   78 42.77    44.41      1       0.37159
## 127   80 42.77    44.41      1       0.38657
## 128   85 42.77    44.41      1       0.42492
## 129   88 42.77    44.41      1       0.44840
## 130   89 42.77    44.41      1       0.45629
## 131    1 42.77    44.41      2       0.07086
## 132    2 42.77    44.41      2       0.07298
## 133    4 42.77    44.41      2       0.07741
## 134    5 42.77    44.41      2       0.07971
## 135    6 42.77    44.41      2       0.08207
## 136    8 42.77    44.41      2       0.08700
## 137   10 42.77    44.41      2       0.09219
## 138   12 42.77    44.41      2       0.09766
## 139   13 42.77    44.41      2       0.10050
## 140   14 42.77    44.41      2       0.10341
## 141   15 42.77    44.41      2       0.10640
## 142   16 42.77    44.41      2       0.10947
## 143   17 42.77    44.41      2       0.11261
## 144   18 42.77    44.41      2       0.11583
## 145   20 42.77    44.41      2       0.12251
## 146   21 42.77    44.41      2       0.12597
## 147   24 42.77    44.41      2       0.13686
## 148   25 42.77    44.41      2       0.14067
## 149   26 42.77    44.41      2       0.14456
## 150   27 42.77    44.41      2       0.14854
## 151   28 42.77    44.41      2       0.15261
## 152   29 42.77    44.41      2       0.15677
## 153   30 42.77    44.41      2       0.16103
## 154   31 42.77    44.41      2       0.16537
## 155   32 42.77    44.41      2       0.16981
## 156   33 42.77    44.41      2       0.17435
## 157   34 42.77    44.41      2       0.17898
## 158   35 42.77    44.41      2       0.18370
## 159   36 42.77    44.41      2       0.18852
## 160   37 42.77    44.41      2       0.19344
## 161   38 42.77    44.41      2       0.19845
## 162   39 42.77    44.41      2       0.20356
## 163   40 42.77    44.41      2       0.20877
## 164   41 42.77    44.41      2       0.21408
## 165   42 42.77    44.41      2       0.21948
## 166   43 42.77    44.41      2       0.22498
## 167   44 42.77    44.41      2       0.23058
## 168   45 42.77    44.41      2       0.23628
## 169   46 42.77    44.41      2       0.24207
## 170   47 42.77    44.41      2       0.24796
## 171   48 42.77    44.41      2       0.25394
## 172   49 42.77    44.41      2       0.26002
## 173   50 42.77    44.41      2       0.26619
## 174   51 42.77    44.41      2       0.27245
## 175   52 42.77    44.41      2       0.27880
## 176   53 42.77    44.41      2       0.28525
## 177   54 42.77    44.41      2       0.29178
## 178   55 42.77    44.41      2       0.29840
## 179   56 42.77    44.41      2       0.30511
## 180   57 42.77    44.41      2       0.31190
## 181   58 42.77    44.41      2       0.31877
## 182   60 42.77    44.41      2       0.33275
## 183   62 42.77    44.41      2       0.34703
## 184   64 42.77    44.41      2       0.36159
## 185   65 42.77    44.41      2       0.36897
## 186   66 42.77    44.41      2       0.37641
## 187   67 42.77    44.41      2       0.38391
## 188   70 42.77    44.41      2       0.40673
## 189   72 42.77    44.41      2       0.42218
## 190   75 42.77    44.41      2       0.44562
## 191   78 42.77    44.41      2       0.46932
## 192   80 42.77    44.41      2       0.48520
## 193   85 42.77    44.41      2       0.52496
## 194   88 42.77    44.41      2       0.54869
## 195   89 42.77    44.41      2       0.55656
## 196    1 42.77    44.41      3       0.10238
## 197    2 42.77    44.41      3       0.10534
## 198    4 42.77    44.41      3       0.11149
## 199    5 42.77    44.41      3       0.11468
## 200    6 42.77    44.41      3       0.11795
## 201    8 42.77    44.41      3       0.12474
## 202   10 42.77    44.41      3       0.13186
## 203   12 42.77    44.41      3       0.13932
## 204   13 42.77    44.41      3       0.14318
## 205   14 42.77    44.41      3       0.14712
## 206   15 42.77    44.41      3       0.15116
## 207   16 42.77    44.41      3       0.15529
## 208   17 42.77    44.41      3       0.15951
## 209   18 42.77    44.41      3       0.16383
## 210   20 42.77    44.41      3       0.17273
## 211   21 42.77    44.41      3       0.17733
## 212   24 42.77    44.41      3       0.19169
## 213   25 42.77    44.41      3       0.19667
## 214   26 42.77    44.41      3       0.20175
## 215   27 42.77    44.41      3       0.20692
## 216   28 42.77    44.41      3       0.21219
## 217   29 42.77    44.41      3       0.21756
## 218   30 42.77    44.41      3       0.22303
## 219   31 42.77    44.41      3       0.22859
## 220   32 42.77    44.41      3       0.23426
## 221   33 42.77    44.41      3       0.24001
## 222   34 42.77    44.41      3       0.24587
## 223   35 42.77    44.41      3       0.25182
## 224   36 42.77    44.41      3       0.25786
## 225   37 42.77    44.41      3       0.26400
## 226   38 42.77    44.41      3       0.27023
## 227   39 42.77    44.41      3       0.27655
## 228   40 42.77    44.41      3       0.28296
## 229   41 42.77    44.41      3       0.28946
## 230   42 42.77    44.41      3       0.29605
## 231   43 42.77    44.41      3       0.30273
## 232   44 42.77    44.41      3       0.30949
## 233   45 42.77    44.41      3       0.31633
## 234   46 42.77    44.41      3       0.32326
## 235   47 42.77    44.41      3       0.33026
## 236   48 42.77    44.41      3       0.33734
## 237   49 42.77    44.41      3       0.34449
## 238   50 42.77    44.41      3       0.35171
## 239   51 42.77    44.41      3       0.35900
## 240   52 42.77    44.41      3       0.36636
## 241   53 42.77    44.41      3       0.37378
## 242   54 42.77    44.41      3       0.38126
## 243   55 42.77    44.41      3       0.38879
## 244   56 42.77    44.41      3       0.39638
## 245   57 42.77    44.41      3       0.40402
## 246   58 42.77    44.41      3       0.41171
## 247   60 42.77    44.41      3       0.42721
## 248   62 42.77    44.41      3       0.44285
## 249   64 42.77    44.41      3       0.45861
## 250   65 42.77    44.41      3       0.46652
## 251   66 42.77    44.41      3       0.47445
## 252   67 42.77    44.41      3       0.48239
## 253   70 42.77    44.41      3       0.50625
## 254   72 42.77    44.41      3       0.52215
## 255   75 42.77    44.41      3       0.54591
## 256   78 42.77    44.41      3       0.56946
## 257   80 42.77    44.41      3       0.58499
## 258   85 42.77    44.41      3       0.62303
## 259   88 42.77    44.41      3       0.64518
## 260   89 42.77    44.41      3       0.65243
## 261    1 42.77    44.41      4       0.14572
## 262    2 42.77    44.41      4       0.14973
## 263    4 42.77    44.41      4       0.15801
## 264    5 42.77    44.41      4       0.16229
## 265    6 42.77    44.41      4       0.16667
## 266    8 42.77    44.41      4       0.17570
## 267   10 42.77    44.41      4       0.18511
## 268   12 42.77    44.41      4       0.19490
## 269   13 42.77    44.41      4       0.19995
## 270   14 42.77    44.41      4       0.20509
## 271   15 42.77    44.41      4       0.21032
## 272   16 42.77    44.41      4       0.21566
## 273   17 42.77    44.41      4       0.22109
## 274   18 42.77    44.41      4       0.22662
## 275   20 42.77    44.41      4       0.23797
## 276   21 42.77    44.41      4       0.24379
## 277   24 42.77    44.41      4       0.26182
## 278   25 42.77    44.41      4       0.26802
## 279   26 42.77    44.41      4       0.27431
## 280   27 42.77    44.41      4       0.28069
## 281   28 42.77    44.41      4       0.28716
## 282   29 42.77    44.41      4       0.29372
## 283   30 42.77    44.41      4       0.30036
## 284   31 42.77    44.41      4       0.30709
## 285   32 42.77    44.41      4       0.31391
## 286   33 42.77    44.41      4       0.32080
## 287   34 42.77    44.41      4       0.32778
## 288   35 42.77    44.41      4       0.33483
## 289   36 42.77    44.41      4       0.34195
## 290   37 42.77    44.41      4       0.34915
## 291   38 42.77    44.41      4       0.35642
## 292   39 42.77    44.41      4       0.36375
## 293   40 42.77    44.41      4       0.37115
## 294   41 42.77    44.41      4       0.37861
## 295   42 42.77    44.41      4       0.38612
## 296   43 42.77    44.41      4       0.39370
## 297   44 42.77    44.41      4       0.40132
## 298   45 42.77    44.41      4       0.40899
## 299   46 42.77    44.41      4       0.41670
## 300   47 42.77    44.41      4       0.42446
## 301   48 42.77    44.41      4       0.43225
## 302   49 42.77    44.41      4       0.44008
## 303   50 42.77    44.41      4       0.44794
## 304   51 42.77    44.41      4       0.45582
## 305   52 42.77    44.41      4       0.46373
## 306   53 42.77    44.41      4       0.47165
## 307   54 42.77    44.41      4       0.47959
## 308   55 42.77    44.41      4       0.48753
## 309   56 42.77    44.41      4       0.49549
## 310   57 42.77    44.41      4       0.50345
## 311   58 42.77    44.41      4       0.51140
## 312   60 42.77    44.41      4       0.52729
## 313   62 42.77    44.41      4       0.54312
## 314   64 42.77    44.41      4       0.55887
## 315   65 42.77    44.41      4       0.56670
## 316   66 42.77    44.41      4       0.57450
## 317   67 42.77    44.41      4       0.58226
## 318   70 42.77    44.41      4       0.60529
## 319   72 42.77    44.41      4       0.62039
## 320   75 42.77    44.41      4       0.64260
## 321   78 42.77    44.41      4       0.66422
## 322   80 42.77    44.41      4       0.67827
## 323   85 42.77    44.41      4       0.71197
## 324   88 42.77    44.41      4       0.73115
## 325   89 42.77    44.41      4       0.73736
```
